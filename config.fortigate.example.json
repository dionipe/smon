{
  "comment": "Fortigate Device Configuration Example for SMON",
  "fortigateSampleDevices": [
    {
      "id": "fg-branch-1",
      "name": "FortiGate-60E Branch 1",
      "host": "192.168.1.100",
      "community": "public",
      "version": "2c",
      "timeout": 5000,
      "retries": 2,
      "pollingInterval": 60000,
      "selectedInterfaces": [
        {
          "index": 1,
          "name": "port1",
          "description": "WAN (Internet)"
        },
        {
          "index": 2,
          "name": "port2",
          "description": "LAN (Internal)"
        },
        {
          "index": 3,
          "name": "port3",
          "description": "DMZ"
        },
        {
          "index": 10,
          "name": "internal",
          "description": "Internal Switch"
        }
      ],
      "notes": "Basic 3-port FortiGate with internal switch monitoring"
    },
    {
      "id": "fg-datacenter",
      "name": "FortiGate-3100D HA Cluster",
      "host": "192.168.1.50",
      "community": "monitoring_secure",
      "version": "2c",
      "timeout": 5000,
      "retries": 2,
      "pollingInterval": 60000,
      "selectedInterfaces": [
        {
          "index": 1,
          "name": "port1"
        },
        {
          "index": 2,
          "name": "port2"
        },
        {
          "index": 3,
          "name": "port3"
        },
        {
          "index": 4,
          "name": "port4"
        },
        {
          "index": 5,
          "name": "port5",
          "description": "Management Interface"
        },
        {
          "index": 6,
          "name": "port6",
          "description": "HA Sync"
        },
        {
          "index": 10,
          "name": "internal"
        }
      ],
      "notes": "High-end HA cluster with 6 physical ports + internal switch"
    },
    {
      "id": "fg-remote-office",
      "name": "FortiGate-40F Remote Office",
      "host": "203.45.67.89",
      "community": "public",
      "version": "2c",
      "timeout": 5000,
      "retries": 2,
      "pollingInterval": 120000,
      "selectedInterfaces": [
        {
          "index": 1,
          "name": "port1",
          "description": "WAN"
        },
        {
          "index": 2,
          "name": "port2",
          "description": "LAN"
        },
        {
          "index": 3,
          "name": "port3",
          "description": "Guest WiFi"
        }
      ],
      "notes": "Small office appliance with 3 interfaces, 2-minute polling"
    },
    {
      "id": "fg-vpn-gateway",
      "name": "FortiGate-5000 VPN Concentrator",
      "host": "10.0.0.1",
      "community": "vpn_monitoring",
      "version": "2c",
      "timeout": 10000,
      "retries": 3,
      "pollingInterval": 60000,
      "selectedInterfaces": [
        {
          "index": 1,
          "name": "port1",
          "description": "Primary WAN"
        },
        {
          "index": 2,
          "name": "port2",
          "description": "Secondary WAN"
        },
        {
          "index": 3,
          "name": "port3",
          "description": "Management Network"
        },
        {
          "index": 10,
          "name": "internal"
        }
      ],
      "notes": "Large VPN gateway with redundant WAN, longer timeout due to load"
    },
    {
      "id": "fg-vm-cloud",
      "name": "FortiGate VM - AWS",
      "host": "10.20.30.40",
      "community": "public",
      "version": "2c",
      "timeout": 5000,
      "retries": 2,
      "pollingInterval": 60000,
      "selectedInterfaces": [
        {
          "index": 1,
          "name": "eth0",
          "description": "Public Subnet"
        },
        {
          "index": 2,
          "name": "eth1",
          "description": "Private Subnet"
        },
        {
          "index": 10,
          "name": "internal"
        }
      ],
      "notes": "Fortigate VM instance in AWS with 2 ENIs"
    }
  ],
  "monitoringSetup": {
    "bandwidthDashboard": {
      "description": "Multi-device bandwidth monitoring",
      "defaultRefresh": "30s",
      "availableRefreshIntervals": ["0s", "30s", "60s", "5min", "10min"],
      "chartTimeRanges": ["1h", "6h", "24h", "7d", "30d"]
    },
    "cpuMonitoring": {
      "description": "Automatic CPU usage monitoring via fgSysCpuUsage OID",
      "oid": "1.3.6.1.4.1.12356.101.4.1.3.0",
      "unit": "percentage",
      "range": "0-100",
      "failureHandling": "Disables after 5 consecutive failures, retries every 1 hour"
    },
    "memoryMonitoring": {
      "description": "Optional memory usage monitoring",
      "oid": "1.3.6.1.4.1.12356.101.4.1.4.0",
      "unit": "percentage",
      "range": "0-100",
      "status": "OID available, not yet displayed in UI"
    },
    "haMonitoring": {
      "description": "High Availability cluster status",
      "status_oid": "1.3.6.1.4.1.12356.101.13.2.1.0",
      "master_serial_oid": "1.3.6.1.4.1.12356.101.13.2.1.2.0",
      "slave_serial_oid": "1.3.6.1.4.1.12356.101.13.2.1.3.0",
      "status": "OIDs available, can be queried on demand"
    }
  },
  "snmpSettings": {
    "v2c": {
      "description": "SNMP Version 2c (Community-based)",
      "recommended": true,
      "security": "Low - community string transmitted in clear",
      "compatibility": "Wide - works on all Fortigate models",
      "communityExample": "public",
      "timeout_ms": 5000,
      "retries": 2
    },
    "v3": {
      "description": "SNMP Version 3 (User-based with authentication and privacy)",
      "recommended": true,
      "security": "High - encrypted with authentication",
      "compatibility": "FortiOS 6.4+ required",
      "fortiOS_6_4_config": {
        "command": "config system snmp user",
        "authProtocol": "sha|md5",
        "privProtocol": "aes|des"
      },
      "timeout_ms": 5000,
      "retries": 2
    }
  },
  "interfaceTypes": {
    "physical": ["port1", "port2", "port3", "port4", "port5", "port6"],
    "internal_switch": ["internal"],
    "virtual": ["vlan100", "vlan200", "ssl.root"],
    "tunnel": ["ipsec1", "ipsec2", "ssl1"],
    "management": ["mgmt1", "mgmt2"]
  },
  "performanceTips": {
    "pollingInterval": {
      "recommended": 60000,
      "minimum": 30000,
      "maximum": 300000,
      "note": "60 seconds is good balance between responsiveness and load"
    },
    "timeout": {
      "recommended": 5000,
      "note": "Increase to 10000 for heavily loaded devices or over WAN"
    },
    "maxConcurrentDevices": {
      "recommended": 10,
      "note": "Limit concurrent SNMP polling to avoid overwhelming FortiGate"
    },
    "interfaceSelection": {
      "note": "Select only interfaces you need to monitor - reduces query time"
    }
  },
  "troubleshooting": {
    "deviceNotDetected": {
      "step1": "Verify SNMP is enabled on FortiGate device",
      "step2": "Test: snmpwalk -v2c -c public <ip> 1.3.6.1.2.1.1.1.0",
      "step3": "Response should contain 'FortiGate' or 'Fortinet'"
    },
    "cpuNotAppearing": {
      "step1": "Check logs for: '[DeviceID] CPU SNMP not supported'",
      "step2": "Test: snmpget -v2c -c public <ip> 1.3.6.1.4.1.12356.101.4.1.3.0",
      "step3": "Verify SNMP community string is correct"
    },
    "interfaceNotFound": {
      "step1": "List all interfaces: snmpwalk -v2c -c public <ip> 1.3.6.1.2.1.2.2.1.2",
      "step2": "Find the index of your interface",
      "step3": "Add to selectedInterfaces with correct index"
    }
  },
  "vendorDetection": {
    "method": "Automatic via sysDescr (OID 1.3.6.1.2.1.1.1.0)",
    "detection_keywords": ["fortigate", "fortinet"],
    "case_sensitive": false,
    "example_sysDescr": "FortiGate-60E v6.4.5,build 0000,202301301234"
  }
}
